<div class="admin-dashboard">
  <div class="dashboard-header">
    <h1>Dashboard Amministratore</h1>
    <p>Gestisci voli, compagnie aeree e aeroporti</p>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Caricamento dashboard...</p>
  </div>

  <!-- Error State -->
  <div class="status-message error" *ngIf="error && !loading">
    <mat-icon>error</mat-icon>
    <span>{{ error }}</span>
    <button class="btn-primary" (click)="loadDashboardData()">Riprova</button>
  </div>

  <div class="dashboard-content" *ngIf="!loading && !error">
    <!-- Quick Actions -->
    <div class="quick-actions">
      <div class="actions-grid">
        <mat-card class="action-card" routerLink="/admin/users">
          <mat-card-content>
            <mat-icon>people</mat-icon>
            <h3>Gestione Utenti</h3>
            <p>Gestisci utenti e invita compagnie aeree</p>
          </mat-card-content>
        </mat-card>

        <mat-card class="action-card">
          <mat-card-content>
            <mat-icon>flight</mat-icon>
            <h3>Gestione Voli</h3>
            <p>Supervisiona tutti i voli del sistema</p>
          </mat-card-content>
        </mat-card>

        <mat-card class="action-card">
          <mat-card-content>
            <mat-icon>analytics</mat-icon>
            <h3>Report</h3>
            <p>Visualizza statistiche e report</p>
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-grid">
      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>flight</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ totalFlights }}</h3>
            <p>Voli Totali</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>flight_takeoff</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ activeFlights }}</h3>
            <p>Voli Attivi</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>business</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ totalAirlines }}</h3>
            <p>Compagnie Aeree</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Recent Flights -->
    <mat-card class="data-card">
      <mat-card-header>
        <mat-card-title>Voli Recenti</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="table-container">
          <table mat-table [dataSource]="flights.slice(0, 10)" class="flights-table">
            <!-- Flight Number Column -->
            <ng-container matColumnDef="flightNumber">
              <th mat-header-cell *matHeaderCellDef>Volo</th>
              <td mat-cell *matCellDef="let flight">{{ flight.flightNumber }}</td>
            </ng-container>

            <!-- Airline Column -->
            <ng-container matColumnDef="airline">
              <th mat-header-cell *matHeaderCellDef>Compagnia</th>
              <td mat-cell *matCellDef="let flight">{{ flight.airline?.name || 'N/A' }}</td>
            </ng-container>

            <!-- Route Column -->
            <ng-container matColumnDef="route">
              <th mat-header-cell *matHeaderCellDef>Rotta</th>
              <td mat-cell *matCellDef="let flight">
                {{ flight.departureAirport?.code }} â†’ {{ flight.arrivalAirport?.code }}
              </td>
            </ng-container>

            <!-- Departure Column -->
            <ng-container matColumnDef="departure">
              <th mat-header-cell *matHeaderCellDef>Partenza</th>
              <td mat-cell *matCellDef="let flight">
                {{ flight.departureTime | date:'dd/MM/yyyy HH:mm' }}
              </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>Stato</th>
              <td mat-cell *matCellDef="let flight">
                <mat-chip [color]="getFlightStatusColor(flight.status)" selected>
                  {{ getFlightStatusText(flight.status) }}
                </mat-chip>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['flightNumber', 'airline', 'route', 'departure', 'status']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['flightNumber', 'airline', 'route', 'departure', 'status'];"></tr>
          </table>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Airlines List -->
    <mat-card class="data-card">
      <mat-card-header>
        <mat-card-title>Compagnie Aeree</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="airlines-grid">
          <div *ngFor="let airline of airlines.slice(0, 6)" class="airline-item">
            <div class="airline-info">
              <h4>{{ airline.name }}</h4>
              <p>{{ airline.code }}</p>
            </div>
            <mat-chip [color]="airline.isActive ? 'primary' : 'accent'" selected>
              {{ airline.isActive ? 'Attiva' : 'Inattiva' }}
            </mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>