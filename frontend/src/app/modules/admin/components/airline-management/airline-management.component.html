<div class="airline-management">
    <div class="header">
        <h1>Airline Management</h1>
        <p>{{ totalAirlines }} airlines registered</p>
    </div>

    <div class="actions-section">
        <button class="invite-button" (click)="openInviteDialog()" type="button">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6">
                </path>
            </svg>
            Invita Compagnia Aerea
        </button>
    </div>

    <div class="search-section">
        <div class="search-container">
            <label class="search-label">Cerca compagnie aeree</label>
            <input type="text" class="search-input-styled" [(ngModel)]="searchTerm" (input)="onSearch($event)"
                placeholder="Nome, codice IATA o email">
        </div>
    </div>

    <div class="airlines-list" *ngIf="!loading">
        <div class="airline-card" *ngFor="let airline of airlines; let i = index">
            <div class="airline-icon">
                <mat-icon>flight</mat-icon>
            </div>
            <div class="airline-info">
                <div class="airline-name">{{ airline.name }}</div>
                <div class="airline-details">{{ airline.code }} â€¢ {{ airline.country }}</div>
                <div class="airline-contact">{{ airline.contactEmail }}</div>
            </div>
            <div class="airline-status">
                <span class="status-badge" [class.active]="airline.isActive" [class.inactive]="!airline.isActive">
                    {{ airline.isActive ? 'Active' : 'Inactive' }}
                </span>
            </div>
            <div class="airline-date">
                {{ airline.createdAt | date:'MMM d, y' }}
            </div>
            <div class="airline-actions">
                <button mat-icon-button color="primary" (click)="viewAirlineDetails(airline)"
                    matTooltip="Visualizza dettagli">
                    <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button [color]="airline.isActive ? 'warn' : 'primary'"
                    (click)="toggleAirlineStatus(airline)" [matTooltip]="airline.isActive ? 'Disattiva' : 'Attiva'">
                    <mat-icon>{{ airline.isActive ? 'block' : 'check_circle' }}</mat-icon>
                </button>
            </div>
        </div>

        <div class="no-results" *ngIf="airlines.length === 0">
            <mat-icon>flight_off</mat-icon>
            <p>No airlines found</p>
        </div>

        <!-- Pagination -->
        <div class="pagination-container" *ngIf="totalPages > 1">
            <div class="pagination">
                <button class="pagination-btn" [disabled]="currentPage === 1" (click)="changePage(1)"
                    [class.disabled]="currentPage === 1">
                    <span>First</span>
                </button>

                <button class="pagination-btn" [disabled]="currentPage === 1" (click)="changePage(currentPage - 1)"
                    [class.disabled]="currentPage === 1">
                    <span>Previous</span>
                </button>

                <div class="pagination-pages">
                    <button *ngFor="let page of getVisiblePages()" class="pagination-btn page-number"
                        [class.active]="page === currentPage" (click)="changePage(page)">
                        {{ page }}
                    </button>
                </div>

                <button class="pagination-btn" [disabled]="currentPage === totalPages"
                    (click)="changePage(currentPage + 1)" [class.disabled]="currentPage === totalPages">
                    <span>Next</span>
                </button>

                <button class="pagination-btn" [disabled]="currentPage === totalPages" (click)="changePage(totalPages)"
                    [class.disabled]="currentPage === totalPages">
                    <span>Last</span>
                </button>
            </div>

            <div class="pagination-info">
                Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, totalAirlines) }}
                of {{ totalAirlines }} airlines
            </div>
        </div>
    </div>

    <div class="loading" *ngIf="loading">
        <mat-spinner></mat-spinner>
        <p>Loading airlines...</p>
    </div>
</div>

<!-- Airline Invitation Dialog -->
<app-airline-invitation-dialog *ngIf="showInviteDialog" [isVisible]="showInviteDialog"
    (dialogClosed)="onInviteDialogClosed($event)">
</app-airline-invitation-dialog>