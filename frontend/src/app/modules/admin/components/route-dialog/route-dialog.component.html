<div class="route-dialog-clean" *ngIf="isVisible">
    <div class="dialog-header-clean">
        <h2>{{ data.isEdit ? 'Modifica' : 'Aggiungi' }} Rotta</h2>
        <p>{{ data.isEdit ? 'Modifica i dettagli della rotta esistente' : 'Crea una nuova rotta di volo' }}</p>
    </div>

    <div class="dialog-content-clean">
        <form [formGroup]="routeForm" (ngSubmit)="onSubmit()" class="route-form">
            <!-- Origin and Destination -->
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Aeroporto di Partenza</label>
                    <input type="text" class="form-input" formControlName="origin" placeholder="Es. MXP, FCO, BGY"
                        maxlength="3" style="text-transform: uppercase;">
                    <div class="form-error"
                        *ngIf="routeForm.get('origin')?.hasError('required') && routeForm.get('origin')?.touched">
                        Aeroporto di partenza richiesto
                    </div>
                    <div class="form-error"
                        *ngIf="routeForm.get('origin')?.hasError('pattern') && routeForm.get('origin')?.touched">
                        Inserisci codice IATA valido (3 lettere)
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Aeroporto di Arrivo</label>
                    <input type="text" class="form-input" formControlName="destination" placeholder="Es. LHR, CDG, BCN"
                        maxlength="3" style="text-transform: uppercase;">
                    <div class="form-error"
                        *ngIf="routeForm.get('destination')?.hasError('required') && routeForm.get('destination')?.touched">
                        Aeroporto di arrivo richiesto
                    </div>
                    <div class="form-error"
                        *ngIf="routeForm.get('destination')?.hasError('pattern') && routeForm.get('destination')?.touched">
                        Inserisci codice IATA valido (3 lettere)
                    </div>
                </div>
            </div>

            <!-- Distance and Flight Time -->
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Distanza (km)</label>
                    <input type="number" class="form-input" formControlName="distance" placeholder="Es. 1200" min="1">
                    <div class="form-error"
                        *ngIf="routeForm.get('distance')?.hasError('required') && routeForm.get('distance')?.touched">
                        Distanza richiesta
                    </div>
                    <div class="form-error"
                        *ngIf="routeForm.get('distance')?.hasError('min') && routeForm.get('distance')?.touched">
                        La distanza deve essere maggiore di 0
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Tempo di Volo (minuti)</label>
                    <input type="number" class="form-input" formControlName="flightTime" placeholder="Es. 150" min="1">
                    <div class="form-error"
                        *ngIf="routeForm.get('flightTime')?.hasError('required') && routeForm.get('flightTime')?.touched">
                        Tempo di volo richiesto
                    </div>
                    <div class="form-error"
                        *ngIf="routeForm.get('flightTime')?.hasError('min') && routeForm.get('flightTime')?.touched">
                        Il tempo di volo deve essere maggiore di 0
                    </div>
                </div>
            </div>

            <!-- Status -->
            <div class="form-group">
                <label class="form-label">Stato</label>
                <select class="form-input" formControlName="status">
                    <option value="active">Attiva</option>
                    <option value="inactive">Inattiva</option>
                </select>
            </div>

            <!-- Error message -->
            <div class="form-error" *ngIf="errorMessage">
                {{ errorMessage }}
            </div>

            <!-- Success message -->
            <div class="form-success" *ngIf="successMessage">
                {{ successMessage }}
            </div>

            <!-- Submit buttons inside form -->
            <div class="dialog-actions-clean">
                <button type="button" class="btn-secondary" (click)="onCancel()" [disabled]="isSubmitting">Annulla</button>
                <button type="submit" class="btn-primary" [disabled]="routeForm.invalid || isSubmitting">
                    {{ isSubmitting ? 'Salvataggio...' : (data.isEdit ? 'Aggiorna' : 'Aggiungi') }}
                </button>
            </div>
        </form>
    </div>
</div>