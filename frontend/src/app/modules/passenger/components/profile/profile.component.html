<div class="auth-page">
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <div class="user-avatar">
        <div class="avatar-circle">
          <span class="avatar-initials">
            {{ (currentUser?.firstName?.charAt(0) || '') + (currentUser?.lastName?.charAt(0) || '') }}
          </span>
        </div>
      </div>
      <h1>{{ currentUser?.firstName }} {{ currentUser?.lastName }}</h1>
      <p>{{ currentUser?.email }}</p>
      <span class="user-badge">{{ currentUser?.role | titlecase }}</span>
    </div>
  </section>

  <!-- Profile Content -->
  <section class="auth-section">
    <div class="container">
      <div class="profile-grid">
        <!-- Quick Actions -->
        <div class="action-card" (click)="navigateToBookings()">
          <div class="card-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
            </svg>
          </div>
          <div class="card-content">
            <h3>Le Mie Prenotazioni</h3>
            <p>Visualizza, gestisci e fai check-in</p>
          </div>
          <div class="card-arrow">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </div>
        </div>

        <div class="action-card" (click)="navigateToChangePassword()">
          <div class="card-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
            </svg>
          </div>
          <div class="card-content">
            <h3>Cambia Password</h3>
            <p>Aggiorna la tua password di accesso</p>
          </div>
          <div class="card-arrow">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </div>
        </div>

        <!-- Wallet Section -->
        <div class="wallet-card">
          <div class="card-icon wallet-icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
            </svg>
          </div>
          <div class="card-content">
            <h3>Portafoglio Virtuale</h3>
            <div class="balance-display">
              <span class="balance-label">Saldo disponibile:</span>
              <span class="balance-amount">€{{ (currentUser?.walletBalance || 0) | number:'1.2-2' }}</span>
            </div>
            <button type="button" class="btn btn-primary" (click)="addFunds()">
              <span>Ricarica</span>
            </button>
          </div>
          <p class="wallet-description">
            Il saldo viene aggiornato automaticamente con i rimborsi delle prenotazioni cancellate.
          </p>
        </div>

        <!-- Profile Form -->
        <div class="profile-form-card">
          <div class="form-header">
            <h3>Informazioni Personali</h3>
            <button type="button" class="btn btn-secondary" (click)="toggleEdit()" [disabled]="loading">
              <span>{{ isEditing ? 'Annulla' : 'Modifica' }}</span>
            </button>
          </div>

          <!-- Success/Error Messages -->
          <div class="success-message" *ngIf="success">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
            <span>{{ success }}</span>
          </div>

          <div class="error-message" *ngIf="error">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span>{{ error }}</span>
          </div>

          <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="auth-form">
            <div class="form-row">
              <div class="form-group">
                <label for="firstName">Nome</label>
                <div class="input-wrapper">
                  <input id="firstName" type="text" formControlName="firstName" [readonly]="!isEditing"
                    class="form-input">
                  <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                </div>
                <div class="error-message" *ngIf="f['firstName'].invalid && f['firstName'].touched">
                  <span *ngIf="f['firstName'].errors?.['required']">Il nome è obbligatorio</span>
                  <span *ngIf="f['firstName'].errors?.['minlength']">Il nome deve avere almeno 2 caratteri</span>
                </div>
              </div>

              <div class="form-group">
                <label for="lastName">Cognome</label>
                <div class="input-wrapper">
                  <input id="lastName" type="text" formControlName="lastName" [readonly]="!isEditing"
                    class="form-input">
                  <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                  </svg>
                </div>
                <div class="error-message" *ngIf="f['lastName'].invalid && f['lastName'].touched">
                  <span *ngIf="f['lastName'].errors?.['required']">Il cognome è obbligatorio</span>
                  <span *ngIf="f['lastName'].errors?.['minlength']">Il cognome deve avere almeno 2 caratteri</span>
                </div>
              </div>

              <div class="form-group">
                <label for="email">Email</label>
                <div class="input-wrapper">
                  <input id="email" type="email" formControlName="email" readonly class="form-input">
                  <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207">
                    </path>
                  </svg>
                </div>
                <p class="form-hint">L'email non può essere modificata</p>
              </div>

              <div class="form-actions" *ngIf="isEditing">
                <button type="button" class="btn btn-secondary" (click)="toggleEdit()" [disabled]="loading">
                  Annulla
                </button>
                <button type="submit" class="btn btn-primary" [disabled]="loading || profileForm.invalid">
                  <span *ngIf="loading">Salvataggio...</span>
                  <span *ngIf="!loading">Salva Modifiche</span>
                </button>
              </div>
            </div>
          </form>

          <!-- Account Actions -->
          <div class="danger-zone">
            <h3>Azioni Account</h3>
            <div class="danger-actions">
              <button type="button" class="btn btn-outline" (click)="logout()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                  </path>
                </svg>
                Esci dall'Account
              </button>
              <button type="button" class="btn btn-danger" (click)="deleteAccount()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                  </path>
                </svg>
                Elimina Account
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>