<div class="auth-page">
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <div class="logo-container">
        <svg class="logo-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z">
          </path>
        </svg>
        <h1>SkyBooker</h1>
      </div>
      <p>{{ isForceChange ? 'Imposta una nuova password per il tuo account' : 'Aggiorna la tua password attuale' }}</p>
    </div>
  </section>

  <!-- Change Password Section -->
  <section class="auth-section">
    <div class="container">
      <div class="auth-card">
        <div class="auth-header">
          <h2>{{ isForceChange ? 'Imposta Nuova Password' : 'Cambia Password' }}</h2>
          <p>{{ isForceChange ? 'Crea una password sicura per continuare' : 'Mantieni il tuo account sicuro' }}</p>
        </div>

        <!-- Regular Password Change Form -->
        <form *ngIf="!isForceChange" [formGroup]="changePasswordForm" (ngSubmit)="onChangePassword()" class="auth-form">
          <div class="form-group">
            <label for="currentPassword">Password Attuale</label>
            <div class="input-wrapper">
              <input id="currentPassword" type="password" formControlName="currentPassword"
                placeholder="Inserisci la password attuale" class="form-input">
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
              </svg>
            </div>
            <div class="error-message" *ngIf="f['currentPassword'].invalid && f['currentPassword'].touched">
              <span *ngIf="f['currentPassword'].errors?.['required']">La password attuale è richiesta</span>
            </div>
          </div>

          <div class="form-group">
            <label for="newPassword">Nuova Password</label>
            <div class="input-wrapper">
              <input id="newPassword" type="password" formControlName="newPassword"
                placeholder="Inserisci la nuova password" class="form-input">
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
              </svg>
            </div>
            <div class="error-message" *ngIf="f['newPassword'].invalid && f['newPassword'].touched">
              <span *ngIf="f['newPassword'].errors?.['required']">La nuova password è richiesta</span>
              <span *ngIf="f['newPassword'].errors?.['minlength']">La password deve essere di almeno 6 caratteri</span>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Conferma Nuova Password</label>
            <div class="input-wrapper">
              <input id="confirmPassword" type="password" formControlName="confirmPassword"
                placeholder="Conferma la nuova password" class="form-input">
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
              </svg>
            </div>
            <div class="error-message" *ngIf="f['confirmPassword'].invalid && f['confirmPassword'].touched">
              <span *ngIf="f['confirmPassword'].errors?.['required']">Conferma la nuova password</span>
              <span *ngIf="f['confirmPassword'].errors?.['passwordMismatch']">Le password non corrispondono</span>
            </div>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="changePasswordForm.invalid || loading">
              <span *ngIf="loading">Aggiornamento...</span>
              <span *ngIf="!loading">Cambia Password</span>
            </button>
          </div>
        </form>

        <!-- Force Password Change Form -->
        <form *ngIf="isForceChange" [formGroup]="forceChangeForm" (ngSubmit)="onForceChangePassword()"
          class="auth-form">
          <div class="form-group">
            <label for="email">Email</label>
            <div class="input-wrapper">
              <input id="email" type="email" formControlName="email" placeholder="Inserisci la tua email"
                class="form-input" readonly>
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207">
                </path>
              </svg>
            </div>
            <div class="error-message" *ngIf="ff['email'].invalid && ff['email'].touched">
              <span *ngIf="ff['email'].errors?.['required']">L'email è richiesta</span>
              <span *ngIf="ff['email'].errors?.['email']">Inserisci un'email valida</span>
            </div>
          </div>

          <div class="form-group">
            <label for="temporaryPassword">Password Temporanea</label>
            <div class="input-wrapper">
              <input id="temporaryPassword" type="password" formControlName="temporaryPassword"
                placeholder="Inserisci la password temporanea" class="form-input">
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z">
                </path>
              </svg>
            </div>
            <div class="error-message" *ngIf="ff['temporaryPassword'].invalid && ff['temporaryPassword'].touched">
              <span *ngIf="ff['temporaryPassword'].errors?.['required']">La password temporanea è richiesta</span>
            </div>
          </div>
          <div class="form-group">
            <label for="newPassword">Nuova Password</label>
            <div class="input-wrapper">
              <input id="newPassword" type="password" formControlName="newPassword"
                placeholder="Inserisci la nuova password" class="form-input">
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
              </svg>
            </div>
            <div class="error-message" *ngIf="ff['newPassword'].invalid && ff['newPassword'].touched">
              <span *ngIf="ff['newPassword'].errors?.['required']">La nuova password è richiesta</span>
              <span *ngIf="ff['newPassword'].errors?.['minlength']">La password deve essere di almeno 6 caratteri</span>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPasswordForce">Conferma Nuova Password</label>
            <div class="input-wrapper">
              <input id="confirmPasswordForce" type="password" formControlName="confirmPassword"
                placeholder="Conferma la nuova password" class="form-input">
              <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 15v2m-6 0h12a2 2 0 002-2V7a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
              </svg>
            </div>
            <div class="error-message" *ngIf="ff['confirmPassword'].invalid && ff['confirmPassword'].touched">
              <span *ngIf="ff['confirmPassword'].errors?.['required']">Conferma la nuova password</span>
              <span *ngIf="ff['confirmPassword'].errors?.['passwordMismatch']">Le password non corrispondono</span>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" [disabled]="forceChangeForm.invalid || loading">
              <span *ngIf="loading">Impostazione...</span>
              <span *ngIf="!loading">Imposta Nuova Password</span>
            </button>
          </div>
        </form>

        <!-- Status Messages -->
        <div class="success-message" *ngIf="success">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          <span>{{ success }}</span>
        </div>

        <div class="error-message" *ngIf="error">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span>{{ error }}</span>
        </div>

        <!-- Toggle Mode for non-force change -->
        <div class="auth-footer" *ngIf="!isForceChange">
          <p>Hai bisogno di usare una password temporanea?</p>
          <button type="button" class="btn-link" (click)="toggleMode()">Clicca qui</button>
        </div>
      </div>
    </div>
  </section>
</div>